<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>ROSc: static_pubsub.c</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../rosc.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../rosc_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ROSc
   </div>
   <div id="projectbrief">A portable, dependency-free ROS client library in pure C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/d78/static_pubsub_8c-example.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">static_pubsub.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>This file should give you an overview about how to create a subscriber.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> *  Copyright (c) 2013, Synapticon GmbH</span></div>
<div class="line"><span class="comment"> *      All rights reserved.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *      Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment"> *      modification, are permitted provided that the following conditions are met: </span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *      1. Redistributions of source code must retain the above copyright notice, this</span></div>
<div class="line"><span class="comment"> *         list of conditions and the following disclaimer. </span></div>
<div class="line"><span class="comment"> *      2. Redistributions in binary form must reproduce the above copyright notice,</span></div>
<div class="line"><span class="comment"> *     this list of conditions and the following disclaimer in the documentation</span></div>
<div class="line"><span class="comment"> *     and/or other materials provided with the distribution. </span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *      THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND</span></div>
<div class="line"><span class="comment"> *      ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span></div>
<div class="line"><span class="comment"> *      WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span></div>
<div class="line"><span class="comment"> *      DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR</span></div>
<div class="line"><span class="comment"> *      ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div>
<div class="line"><span class="comment"> *      (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span></div>
<div class="line"><span class="comment"> *      LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span></div>
<div class="line"><span class="comment"> *      ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment"> *      (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span></div>
<div class="line"><span class="comment"> *      SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *      The views and conclusions contained in the software and documentation are those</span></div>
<div class="line"><span class="comment"> *      of the authors and should not be interpreted as representing official policies, </span></div>
<div class="line"><span class="comment"> *      either expressed or implied, of the FreeBSD Project.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  static_pubsub.c created by Christian Holl</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  IMPORTANT NOTE:</span></div>
<div class="line"><span class="comment"> *  This is a usage example, it&#39;s copied from rosc_linux_test from one state of the project.</span></div>
<div class="line"><span class="comment"> *  rosc_linux_test is used for developing so it is highly possible that this example will NOT</span></div>
<div class="line"><span class="comment"> *  compile at all because the messages changed.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Include rosc.h */</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../df/d03/rosc_8h.html">rosc/rosc.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Include the header files from the messages you want to use */</span></div>
<div class="line"><span class="preprocessor">#include &lt;rosc/msg/rosc_linux_test/simple1.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;rosc/msg/rosc_linux_test/simple2.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Import their buildup information with these macros</span></div>
<div class="line"><span class="comment"> * The name is like the following:</span></div>
<div class="line"><span class="comment"> * ROSC_STATIC_MSG_BUILDUP__PACKAGENAME__MESSAGETYPE</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">ROSC_STATIC_MSG_BUILDUP__rosc_linux_test__simple1();</div>
<div class="line">ROSC_STATIC_MSG_BUILDUP__rosc_linux_test__simple2();</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Create your special userdefined static topic.</span></div>
<div class="line"><span class="comment"> * First of all this step is required for all topic types!</span></div>
<div class="line"><span class="comment"> * Second, if the topic type has dynamic arrays,</span></div>
<div class="line"><span class="comment"> * after the user type of your topic there will be the list of</span></div>
<div class="line"><span class="comment"> * the sizes the included arrays will have at a maximum!</span></div>
<div class="line"><span class="comment"> * If you receive more than this value for an array,</span></div>
<div class="line"><span class="comment"> * those entries will be skipped!</span></div>
<div class="line"><span class="comment"> * ROSC_STATIC_MSG_USER_DEF__PACKAGENAME__MESSAGETYPE(USER_TYPE, ... DYN. ARRAY SIZES ...);</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">ROSC_STATIC_MSG_USER_DEF__rosc_linux_test__simple1(sim1, 4);</div>
<div class="line">ROSC_STATIC_MSG_USER_DEF__rosc_linux_test__simple2(sim2);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * This is the message list, it generates the reserved memory for each</span></div>
<div class="line"><span class="comment"> * socket.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><a name="a0"></a><a class="code" href="../../d9/d40/rosc__init_8h.html#a024aaedee54c124dd7a3261db22cba6a">ROSC_STATIC_SYSTEM_MESSAGE_TYPE_LIST_BEGIN</a></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * This is an entry of the message type list.</span></div>
<div class="line"><span class="comment">         * ROSC_SIZE_LIST_ENTRY__PACKAGENAME_MESSAGETYPE(USER_TYPE)</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        ROSC_SIZE_LIST_ENTRY__rosc_linux_test__simple1(sim1);</div>
<div class="line">        ROSC_SIZE_LIST_ENTRY__rosc_linux_test__simple2(sim2);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* The memory defined here is also used as output buffer, if you want to have a</span></div>
<div class="line"><span class="comment">         * bigger memory to process incoming data faster, you can increase it with this</span></div>
<div class="line"><span class="comment">         * macro. This is optional.</span></div>
<div class="line"><span class="comment">         * ROSC_SIZE_LIST_ENTRY_MIN_XMLRPC_OUTPUT_BUFFER(MINIMUM_BYTE_SIZE);</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a name="a1"></a><a class="code" href="../../d9/d40/rosc__init_8h.html#a08a58918f002ea3669c9ee3fbe5dbae8">ROSC_SIZE_LIST_ENTRY_MIN_XMLRPC_OUTPUT_BUFFER</a>(100);</div>
<div class="line"><a name="a2"></a><a class="code" href="../../d9/d40/rosc__init_8h.html#a00d5e0b45f66195cb80cf0134b82cd70">ROSC_STATIC_SYSTEM_MESSAGE_TYPE_LIST_END</a></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * If you want to use a publisher inside a callback function, it needs to be defined before it</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> ROSC_STATIC_PUBLISHER_INIT__rosc_linux_test__simple2(sim2, pub1, <span class="stringliteral">&quot;/simple1Pub&quot;</span>);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * This is the callback function for your first topic</span></div>
<div class="line"><span class="comment"> * it generates the header for your callback function for you.</span></div>
<div class="line"><span class="comment"> * ROSC_STATIC_CALLBACK_HEAD__PACKAGENAME__MESSAGETYPE(USER_TYPE, TOPIC_REFERENCE)</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">ROSC_STATIC_CALLBACK_HEAD__rosc_linux_test__simple1(sim1,simpleTopic1)</div>
<div class="line">        <span class="comment">/*The message can be accessed with msg*/</span></div>
<div class="line">        printf(&quot;simple1 callback: %i\n&quot;, msg-&gt;EightArray.data[0]);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*Publishing a message*/</span></div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">ROSC_STATIC_CALLBACK_HEAD__rosc_linux_test__simple2(sim2,simpleTopic2)</div>
<div class="line">        printf(&quot;simple2 callback\n&quot;);</div>
<div class="line">        <span class="comment">/* Publishing a topic</span></div>
<div class="line"><span class="comment">         * Not using the wrong message type or publisher variable will NOT result into a compiling error!</span></div>
<div class="line"><span class="comment">         * It will lead also to unpredictable behavior (crashes)!</span></div>
<div class="line"><span class="comment">         * Other words this code has no brain(++), use your own (it&#39;s C not C++)</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a name="a3"></a><a class="code" href="../../de/d76/ros__handler_8h.html#af1c2f54357a93f312b1be46e4ca3c92f">publish</a>(&amp;pub1,msg);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * This macro creates the data structure of the subscriber itself.</span></div>
<div class="line"><span class="comment"> * ROSC_STATIC_SUBSCRIBER_INIT__PACKAGENAME__MESSAGETYPE(USER_TYPE, SUBSCRIBER, TOPIC_STRING)</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">ROSC_STATIC_SUBSCRIBER_INIT__rosc_linux_test__simple1(sim1, sub1, &quot;/simple1&quot;)</div>
<div class="line">ROSC_STATIC_SUBSCRIBER_INIT__rosc_linux_test__simple2(sim2, sub2, &quot;/simple2&quot;)</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * This is a internal list for various hostnames and their IP adresses.</span></div>
<div class="line"><span class="comment"> * This is required, if you do not need that, you can leave it empty.</span></div>
<div class="line"><span class="comment"> * But the HEAD and END macro are mandatory!</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><a name="a4"></a><a class="code" href="../../d1/dd9/eth_8h.html#a78160ebfb9a233e563cd31245fadf4bc">ROSC_STATIC_LOOKUP_TABLE_HEAD</a>()</div>
<div class="line">        <a name="a5"></a><a class="code" href="../../d1/dd9/eth_8h.html#a13db1dde64562564cd040dc8316027ef">ROSC_STATIC_LOOKUP_ENTRY</a>(localhost,<a name="a6"></a><a class="code" href="../../d7/df7/setup_8h.html#a5e67e8cec295646bb6eeac38b6772900">IP</a>(127,0,0,1))</div>
<div class="line">        <a class="code" href="../../d1/dd9/eth_8h.html#a13db1dde64562564cd040dc8316027ef">ROSC_STATIC_LOOKUP_ENTRY</a>(Computer,IP(192,168,0,3))</div>
<div class="line"><a name="a7"></a><a class="code" href="../../d1/dd9/eth_8h.html#ad7cd18dd04423318f0a1a953f0982df1">ROSC_STATIC_LOOKUP_TABLE_END</a></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * This macro creates the string for your master URI</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><a name="a8"></a><a class="code" href="../../d1/dd9/eth_8h.html#a3b9e1c7cacfaaa61c6bacd3f6d0ccf33">MASTER_URI_STATIC</a>(&quot;http:<span class="comment">//localhost:11311&quot;);</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * And this macro specifies your node name, remember, this must be unique in your network!</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><a name="a9"></a><a class="code" href="../../d7/df7/setup_8h.html#aec12f46a888e80a234cb2d5920a2d7bf">NODE_NAME</a>(&quot;roscnode&quot;);</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * This function initializes rosc stuff</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a name="a10"></a><a class="code" href="../../d9/d40/rosc__init_8h.html#a2a5ebf05226bc7c013f346f0a786bfb5">rosc_init</a>();</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * The register interface function makes a interface register at the master</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a name="a11"></a><a class="code" href="../../d1/dd9/eth_8h.html#a2bfe86b94439ef77327d3a964229b798">register_interface</a>(&amp;sub1);</div>
<div class="line">        <a class="code" href="../../d1/dd9/eth_8h.html#a2bfe86b94439ef77327d3a964229b798">register_interface</a>(&amp;sub2);</div>
<div class="line">        <a class="code" href="../../d1/dd9/eth_8h.html#a2bfe86b94439ef77327d3a964229b798">register_interface</a>(&amp;pub1);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * The rosc_spin function starts with port handling</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a name="a12"></a><a class="code" href="../../df/d37/rosc__spin_8h.html#a6390545a8caf4a729b09cc5ac3676c64">rosc_spin</a>();</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Developed at
    <a href="http://www.synapticon.com">
    <img class="footer" style="width: 30%" src="../../synapticon-logo-scaled.png" alt="Synapticon"/></a>&nbsp;(Documentation generated on Tue Dec 10 2013)</li>
  </ul>
</div>
</body>
</html>
